<!DOCTYPE html>
<html lang=" en-US">

<head>

    
    <meta charset="UTF-8"><!-- Include tocNAV javascript -->
    <script type="text/javascript" src="/dcs-notes.github.io/assets/js/tocNav.js"></script>

    <!-- seo used to be here -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style"
        type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/dcs-notes.github.io/assets/css/style.css">
</head>

<body>
    <div id="mainGrid" class="container">
        <header style="padding:10px;" class="page-header notes-header" role="banner">
            <h1 class="project-name">Public Key Cryptography</h1>
        </header>
        <div title="Table of Contents" class="buttonCol" onclick="toggleNav()">
            <div class="navArrow">
                <i></i>
            </div>
        </div>
        <div class="navBox">
            <div id="sidenav" class="sideNav closedNav">
                <h2 style="margin-left: 10px;">Table of Contents</h2><ul><li><a href="#modular-arithmetic">Modular Arithmetic</a></li><li><a href="#the-primitive-root">The Primitive Root</a></li><li><a href="#public-key-encryption">Public Key Encryption</a><ul><li><a href="#rsa-encryption">RSA Encryption</a><ul><li><a href="#finding-the-private-key">Finding the private key</a></li></ul></li><li><a href="#why-is-rsa-secure">Why is RSA secure?</a></li></ul></li><li><a href="#public-key-vs-secret-key-encryption">Public key vs Secret key Encryption</a></li></ul>
</div>
        </div>
        
        <div class="contents">
            <main id="content" class="main-content" role="main">
                <div class="partNav"><a href="/dcs-notes.github.io/CS140/part4.html" title="Cryptography">üëàPrev</a><a href="./" title="CS140 Home">üè°CS140</a><a href="/dcs-notes.github.io/CS140/part6.html" title="Digital Signature & Certificates">Nextüëâ</a></div>
                <!-- Main Content of markdown or sub-layouts-->
                <!-- Each module has its own layout to allow module layouts to be customised -->
<!-- The layout name is also used by the notes layout to display the correct module code -->

<h2 id="modular-arithmetic">Modular Arithmetic</h2>

<ol>
  <li>(A+B) mod n = ((A mod n) + B) mod n</li>
  <li>(A+B) mod n = ((A mod n) + (B mod n)) mod n</li>
  <li>(A*B) mod n = ((A mod n) * B) mod n</li>
  <li>(A*B) mod n = ((A mod n) * (B mod n)) mod n</li>
  <li>x<sup>A*B</sup> mod n = (x<sup>A</sup> mod n)<sup>B</sup> mod n</li>
  <li>(x<sup>A</sup> mod n)<sup>B</sup> mod n = (x<sup>B</sup> mod n)<sup>A</sup> mod n</li>
</ol>

<h2 id="the-primitive-root">The Primitive Root</h2>

<p><em>k = y <sup>x</sup></em> mod p</p>

<p><em>y</em> is the <strong>primitive root mod p</strong> if</p>

<ol>
  <li>Successive powers of <em>y</em> that takes mod p will generate results of 1 to p ‚àí¬†1.</li>
  <li>The generated numbers (<em>k</em>) are distributed uniformly in the range of [1, p ‚àí 1].</li>
</ol>

<blockquote>
  <p>If we pick a value of <strong><em>x</em></strong>, the value of <strong><em>k</em></strong> is equally likely to be any number in [1, p ‚àí 1].</p>
</blockquote>

<p>The above function is an example of a one-way function if</p>

<ul>
  <li><em>y</em> is the <strong>primitive root mod p</strong></li>
  <li><em>p</em> is an enormous number (e.g. 512-bits).</li>
</ul>

<p>This is because if we try a value of <em>x</em> for a given <em>k</em>, the probability that <em>x</em> is <strong>correct</strong> is <strong><em>1/(p-1)</em></strong>.</p>

<h2 id="public-key-encryption">Public Key Encryption</h2>

<blockquote>
  <p>The problem with secret key encryption is that it takes a lot of <strong>effort</strong> to transfer the key safely. There are a few ways:</p>

  <ul>
    <li>Physical Transfer</li>
    <li>Key Distribution Centre</li>
    <li>Online transfer by breaking the key up to ensure security.</li>
  </ul>
</blockquote>

<p>However, public key encryption provides a more <strong>elegant</strong> solution using a <strong>one-way function</strong> like the one <a href="#the-primitive-root">above</a>.</p>

<p>The idea is that each communication party generates a pair of keys, one private and one public ‚Äì KP<sub>a</sub> and KU<sub>a</sub> respectively where <em>a</em> represents one specific party/individual.</p>

<ul>
  <li>Sender of a message uses receiver‚Äôs public key to encrypt</li>
  <li>Receiver uses their own private key to decrypt.</li>
</ul>

<h3 id="rsa-encryption">RSA Encryption</h3>

<p><em>RSA is a type of public key encryption scheme. One of the oldest.</em></p>

<p><strong>To generate a public key.</strong></p>

<ul>
  <li>Choose 2 large secret prime numbers, p and q, and calculate <strong><em>n</em></strong> = p √ó q. <strong><em>n</em></strong> will be the <strong>public key</strong>.</li>
  <li>Select another value <strong><em>e</em></strong>, that is
    <ul>
      <li>relatively prime to <strong><em>p‚Äì1</em></strong>, <strong><em>q‚Äì1</em></strong>, and <strong><em>(p‚Äì1) √ó¬†(q-1)</em></strong>.</li>
      <li><strong><em>1 &lt; e &lt; (p‚Äì1)(q‚Äì1)</em></strong></li>
    </ul>
  </li>
</ul>

<p><strong>To encrypt a message.</strong> <strong><em>C = M<sup>e</sup></em> mod n</strong>, where <strong><em>C</em></strong> is the ciphertext, <strong><em>M</em></strong> is the message.</p>

<blockquote>
  <p>If an eavesdropper gets <strong><em>C</em></strong>, it is <strong>computationally infeasible</strong> to calculate <strong><em>M</em></strong>.</p>
</blockquote>

<p><strong>To generate a private key.</strong></p>

<ul>
  <li>We find a number <strong><em>d</em></strong> such that, <strong><em>e √ó¬†d = 1 mod ((p ‚Äì 1)(q ‚Äì 1))</em></strong></li>
  <li><strong><em>d</em></strong> is the private key owned by Alice and is called the multiplicative inverse of <strong><em>e mod (p‚Äì1)(q‚Äì1)</em></strong>.</li>
</ul>

<p><strong>To decrypt the ciphertext.</strong> <strong><em>M = C<sup>d</sup></em> mod n</strong>. Very easy to decrypt given the private key.</p>

<p>All receivers have to do is to keep the private key <strong>safe.</strong></p>

<h4 id="finding-the-private-key">Finding the private key</h4>

<p>There is a formal method of finding the <a href="https://people.csail.mit.edu/rivest/Rsapaper.pdf">private key</a> (it‚Äôs a 15 page paper).</p>

<p>Another way is by iteration. The goal is to find a multiple of <strong><em>e</em></strong>, which is 1 greater than some multiple of <strong><em>(p‚Äì1)(q‚Äì1)</em></strong>. So iterate through the multiples of <strong><em>(p‚Äì1)(q‚Äì1)</em></strong> and add 1, if that value is a multiple of <strong><em>e</em></strong> you have found a <strong><em>d</em></strong>, otherwise continue to the next multiple.</p>

<h3 id="why-is-rsa-secure">Why is RSA secure?</h3>

<p>To break RSA an attacker must</p>

<ul>
  <li>Either reverse the one-way function which is computationally difficult</li>
  <li>Or know <strong><em>d</em></strong>, which means to know <strong><em>p and q</em></strong> which means to know <strong><em>n</em></strong> ‚Äì but n = p √ó q is also a one-way function.</li>
  <li>The only way is brute force ‚Äì but a large enough key size will make this infeasible.</li>
</ul>

<blockquote>
  <p>To match the security of a 256-bit secret key, the RSA key needs 15460-bits. RSA started with 512-bit public key, but now it is 2048-bits and will need to increase again to 3072-bits from 2030 onwards.</p>
</blockquote>

<p>Another implication of a longer key length, k, is encryption and decryption time increases as well</p>

<ul>
  <li>Encryption time = O(k<sup>2</sup>)</li>
  <li>Decryption time = O(k<sup>3</sup>)</li>
</ul>

<h2 id="public-key-vs-secret-key-encryption">Public key vs Secret key Encryption</h2>

<blockquote>
  <p>DES is between 1000 and 10000 times faster than RSA (encryption &amp; decryption)</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Secret</th>
      <th>Public</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Uses XOR, substitution, permutation ‚Äì <strong>fast</strong></td>
      <td>Uses a one-way function ‚Äì <strong>slower</strong></td>
    </tr>
    <tr>
      <td>Key is secret ‚Äì requires shorter key for <strong>same</strong> level of security<br />Also means its, again, <strong>faster</strong>.</td>
      <td>Only relies on the length of public key to prevent the crack with brute force<br />Long key ‚Äì <strong>slower</strong></td>
    </tr>
    <tr>
      <td>Key distribution is <strong>complicated</strong></td>
      <td>Key distribution is <strong>easy</strong></td>
    </tr>
  </tbody>
</table>


                
                <footer class="site-footer">
                    
                    <span class="site-footer-owner"><a href="https://github.com/CSRG-Group/dcs-notes.github.io">dcs-notes.github.io</a> is maintained by <a href="https://github.com/CSRG-Group">CSRG-Group</a>.</span>
                    
                </footer>
            </main>
        </div>
    </div>
</body>

</html>